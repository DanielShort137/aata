<?xml version="1.0" encoding="UTF-8" ?>

<!-- This file is part of the book                 -->
<!--                                               -->
<!--   Abstract Algebra: Theory and Applications   -->
<!--                                               -->
<!-- Copyright (C) 2010-2014  Robert A. Beezer     -->
<!-- See the file COPYING for copying conditions.  -->

<section xml:id="homomorph-sage">
    <title>Sage</title>

    <introduction>
        <p>Sage is able to create homomorphisms (and by extension, isomorphisms and automorphisms) between finite permutation groups.  There is a limited supply of commands then available to manipulate these functions, but we can still illustrate many of the ideas in this chapter.</p>
    </introduction>

    <subsection>
        <title>Homomorphisms</title>

        <p>The principal device for creating a homomorphism is to specify the specific images of the set of generators for the domain.  Consider cyclic groups of order <m>12</m> and <m>20</m>:<md>
          <mrow>G &amp;= \{a^i\vert a^{12}=e\} &amp; H &amp;= \{x^i\vert x^{20}=e\}</mrow>
        </md> and define a homomorphism by just defining the image of the generator of <m>G</m>, and define the rest of the mapping by extending the mapping via the operation-preserving property of a homomorphism. <md>
          <mrow>\phi: G\rightarrow H, &amp;\quad\phi(a)=x^5</mrow>
          <mrow>\Rightarrow           &amp;\quad\phi(a^i) = \phi(a)^i = (x^5)^i = x ^{5i}</mrow>
        </md>  The constructor <c>PermutationGroupMorphism</c> requires the two groups, then a list of images for each generator (in order!), and then will create the homomorphism.  Note that we can then use the result as a function.  In the example below, we first verify that <c>C12</c> has a single generator (no surprise there), which we then send to a particular element of order <m>4</m> in the codomain.  Sage then constructs the unique homomorphism that is consistent with this requirement.</p>

        <sage>
        <input>
        C12 = CyclicPermutationGroup(12)
        C20 = CyclicPermutationGroup(20)
        domain_gens = C12.gens()
        [g.order() for g in domain_gens]
        </input>
        <output>
        [12]
        </output>
        </sage>

        <sage>
        <input>
        x = C20.gen(0)
        y = x^5
        y.order()
        </input>
        <output>
        4
        </output>
        </sage>

        <sage>
        <input>
        phi = PermutationGroupMorphism(C12, C20, [y])
        phi
        </input>
        <output>
        Permutation group morphism:
          From: Cyclic group of order 12 as a permutation group
          To:   Cyclic group of order 20 as a permutation group
          Defn: [(1,2,3,4,5,6,7,8,9,10,11,12)] ->
                [(1,6,11,16)(2,7,12,17)(3,8,13,18)(4,9,14,19)(5,10,15,20)]
        </output>
        </sage>

        <sage>
        <input>
        a = C12("(1,6,11,4,9,2,7,12,5,10,3,8)")
        phi(a)
        </input>
        <output>
        (1,6,11,16)(2,7,12,17)(3,8,13,18)(4,9,14,19)(5,10,15,20)
        </output>
        </sage>

        <sage>
        <input>
        b = C12("(1,3,5,7,9,11)(2,4,6,8,10,12)")
        phi(b)
        </input>
        <output>
        (1,11)(2,12)(3,13)(4,14)(5,15)(6,16)(7,17)(8,18)(9,19)(10,20)
        </output>
        </sage>

        <sage>
        <input>
        c = C12("(1,9,5)(2,10,6)(3,11,7)(4,12,8)")
        phi(c)
        </input>
        <output>
        ()
        </output>
        </sage>

        <p>Note that the element <c>c</c> must therefore be in the kernel of <c>phi</c>.</p>

        <p>We can then compute the subgroup of the domain that is the kernel, in this case a cyclic group of order <m>3</m> inside the cyclic group of order <m>12</m>.  We can compute the image of <em>any</em> subgroup, but here we will build the whole homomorphic image by supplying the whole domain to the <c>.image()</c> method.  Here the image is a cyclic subgroup of order <m>4</m> inside the cyclic group of order <m>20</m>.  Then we can verify the First Isomorphism Theorem.</p>

        <sage>
        <input>
        K = phi.kernel(); K
        </input>
        <output>
        Subgroup of (Cyclic group of order 12 as a permutation group)
        generated by [(1,5,9)(2,6,10)(3,7,11)(4,8,12)]
        </output>
        </sage>

        <sage>
        <input>
        Im = phi.image(C12); Im
        </input>
        <output>
        Subgroup of (Cyclic group of order 20 as a permutation group)
        generated by [(1,6,11,16)(2,7,12,17)(3,8,13,18)(4,9,14,19)(5,10,15,20)]
        </output>
        </sage>

        <sage>
        <input>
        Im.is_isomorphic(C12.quotient(K))
        </input>
        <output>
        True
        </output>
        </sage>

        <p>Here is a slightly more complicated example.  The dihedral group <m>D_{20}</m> is the symmetry group of a <m>20</m>-gon.  Inside this group is a subgroup that is isomorphic to the symmetry group of a <m>5</m>-gon (pentagon).  Is this a surprise, or is this obvious?  Here is a way to make precise the statement <q><m>D_{20}</m> contains a copy of <m>D_{5}</m>.</q></p>

        <p>We build the domain and find its generators, so we know how many images to supply in the definition of the homomorphism.  Then we construct the codomain, from which we will construct images.  Our choice here is to send a reflection to a reflection, and a rotation to a rotation.  But the rotations will both have order <m>5</m>, and both are a rotation by <m>72</m> degrees.</p>

        <sage>
        <input>
        G = DihedralGroup(5)
        H = DihedralGroup(20)
        G.gens()
        </input>
        <output>
        [(1,2,3,4,5), (1,5)(2,4)]
        </output>
        </sage>

        <sage>
        <input>
        H.gens()
        </input>
        <output>
        [(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20),
         (1,20)(2,19)(3,18)(4,17)(5,16)(6,15)(7,14)(8,13)(9,12)(10,11)]
        </output>
        </sage>

        <sage>
        <input>
        x = H.gen(0)^4
        y = H.gen(1)
        rho = PermutationGroupMorphism(G, H, [x, y])
        rho.kernel()
        </input>
        <output>
        Subgroup of (Dihedral group of order 10 as a permutation group)
        generated by [()]
        </output>
        </sage>

        <p>Since the kernel is trivial, <c>rho</c> is a one-to-one function (see Exercise<nbsp /><xref ref="exercise-trivial-kernel" />).  But more importantly, by the First Isomorphishm Theorem, <c>G</c> is isomorphic to the image of the homomorphism.  We compute the image and check the claim.</p>

        <sage>
        <input>
        Im = rho.image(G); Im
        </input>
        <output>
        Subgroup of (Dihedral group of order 40 as a permutation group)
        generated by
        [(1,5,9,13,17)(2,6,10,14,18)(3,7,11,15,19)(4,8,12,16,20),
        (1,20)(2,19)(3,18)(4,17)(5,16)(6,15)(7,14)(8,13)(9,12)(10,11)]
        </output>
        </sage>

        <sage>
        <input>
        Im.is_subgroup(H)
        </input>
        <output>
        True
        </output>
        </sage>

        <sage>
        <input>
        Im.is_isomorphic(G)
        </input>
        <output>
        True
        </output>
        </sage>

        <p>Just providing a list of images for the generators of the domain is no guarantee that the function will extend to a homomorphism.  For starters, the order of each image must divide the order of the corresponding preimage.  (Can you prove this?)  And similarly, if the domain is abelian, then the image must also be abelian, so in this case the list of images should not generate a non-abelian subgroup.  Here is an example.  There are no homomorphisms from a cyclic group of order <m>7</m> to a cyclic group of order <m>4</m> (other than the trivial function that takes every element to the identity).  To see this, consider the possible orders of the kernel, and of the two possibilities, see that one is impossible and the other arises with the trivial homomorphism.  Unfortunately, Sage acts as if nothing is wrong in creating a homomorphism between these groups, but what Sage builds is useless and raises errors when you try to use it.</p>

        <sage>
        <input>
        G = CyclicPermutationGroup(7)
        H = CyclicPermutationGroup(4)
        tau = PermutationGroupMorphism_im_gens(G, H, H.gens())
        tau
        </input>
        <output>
        Permutation group morphism:
          From: Cyclic group of order 7 as a permutation group
          To:   Cyclic group of order 4 as a permutation group
          Defn: [(1,2,3,4,5,6,7)] -> [(1,2,3,4)]
        </output>
        </sage>

        <sage>
        <input>
        tau.kernel()
        </input>
        <output>
        Traceback (most recent call last):
        ...
        RuntimeError: Gap produced error output
        ...
        </output>
        </sage>

        <p>Rather than creating homomorphisms ourselves, in certain situations Sage knows of the existence of natural homomorphisms and will create them for you.  One such case is a direct product construction.  Given a group <c>G</c>, the method <c>.direct_product(H)</c> will create the direct product <m>G\times H</m>.  (This is not the same command as the function <c>direct_product_permgroups()</c> from before.)  Not only does this command create the direct product, but it also builds <em>four</em> homomorphisms, one with domain <m>G</m>, one with domain <m>H</m> and two with domain <m>G\times H</m>.  So the output consists of five objects, the first being the actual group, and the remainder are homomorphisms.  We will demonstrate the call here, and leave a more thorough investigation for the exercises.</p>

        <sage>
        <input>
        G = CyclicPermutationGroup(3)
        H = DihedralGroup(4)
        results = G.direct_product(H)
        results[0]
        </input>
        <output>
        Permutation Group with generators [(4,5,6,7), (4,7)(5,6), (1,2,3)]
        </output>
        </sage>

        <sage>
        <input>
        results[1]
        </input>
        <output>
        Permutation group morphism:
          From: Cyclic group of order 3 as a permutation group
          To:   Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          Defn: Embedding( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 1 )
        </output>
        </sage>

        <sage>
        <input>
        results[2]
        </input>
        <output>
        Permutation group morphism:
          From: Dihedral group of order 8 as a permutation group
          To:   Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          Defn: Embedding( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 2 )
        </output>
        </sage>

        <sage>
        <input>
        results[3]
        </input>
        <output>
        Permutation group morphism:
          From: Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          To:   Cyclic group of order 3 as a permutation group
          Defn: Projection( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 1 )
        </output>
        </sage>


        <sage>
        <input>
        results[4]
        </input>
        <output>
        Permutation group morphism:
          From: Permutation Group with generators
                [(4,5,6,7), (4,7)(5,6), (1,2,3)]
          To:   Dihedral group of order 8 as a permutation group
          Defn: Projection( Group( [ (1,2,3), (4,5,6,7), (4,7)(5,6) ] ), 2 )
        </output>
        </sage>

    </subsection>

</section>


